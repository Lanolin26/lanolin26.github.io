---
layout: post
title: "Характеристики языка SQL"
categories: sppo-questions pors-questions
---

## Характеристика

Языки запросов — это искусственные языки, на которых делаются запросы к базам данных и другим
информационным системам, особенно к информационно-поисковым системам.

SQL (Structured Query Language) — универсальный компьютерный язык, применяемый для создания,
модификации и управления данными в реляционных базах данных. SQL основывается на реляционной
алгебре.

SQL был разработан в середине 1970-х гг. (IBM). Первой коммерческой системой, в которой
реализован этот язык, была система Oracle (1979 г.). В дальнейшем он был реализован в целом
ряде популярных СУБД для различных типов ЭВМ и операционных систем.

В некоторых СУБД, таких, как Oracle, INGRES, MS SQL-сервер и др., язык SQL используется в
качестве основного. В других системах, например СУБД семейства dBase, Access, AD ABAS и других,
этот язык применяется в качестве альтернативного. Десятки фирм-разработчиков программного
обеспечения создали собственные версии (диалекты) языка SQL. Несмотря на наличие стандарта,
эти версии различаются как по синтаксису, так и по другим характеристикам.

SQL принципиально отличается от традиционных алгоритмических языков программирования прежде
всего тем, что он относится к непроцедурным языкам. На языке типа Си можно записать шаг за
шагом все инструкции, необходимые для исполнения программы. Язык SQL позволяет задать только
то, “что нужно делать”, а само исполнение отдельных операций (“как делать”) возлагается
непосредственно на СУБД. Такой подход в значительной мере определяется самой философией
реляционных баз данных. СУБД в данном случае рассматривается как “черный ящик”, и что
происходит внутри него, пользователя не должно касаться. Его должно интересовать только
внесение в базу данных необходимых изменений и получение правильного ответа на запрос.

Другой особенностью SQL является так называемая трехзначная логика. В большинстве языков
булево выражение может принимать только два значения: истина и ложь. Язык SQL позволяет
записывать в базу данных значение NULL (пустое значение). NULL – это специальный код,
который помещается в столбец таблицы, если по какой-нибудь причине в нем отсутствуют данные.
Когда значение NULL участвует в операциях сравнения, булев результат будет ни истина и ни
ложь, а неизвестно.

Все языки манипулирования данными, созданные для многих СУБД до появления реляционных баз
данных, были ориентированы на операции с данными, представленными в виде логических записей
файлов. Разумеется, это требовало от пользователя детального знания организации хранения
данных и серьезных усилий для указания того, какие данные необходимы, где они размещаются и
как их получить.

Благодаря работающим с файловыми серверами СУБД, множество пользователей получают доступ к
одним и тем же базам данных. Упрощается разработка различных автоматизированных систем
управления организациями. Однако при таком подходе вся обработка запросов из программ или с
терминалов пользовательских ЭВМ на них и выполняется, поэтому для реализации даже простого
запроса необходимо считывать с файлового сервера или записывать на него целые файлы, а это
ведет к конфликтным ситуациям и перегрузке сети. Для исключения указанных недостатков была
предложена технология клиент-сервер, но при этом понадобился единый язык общения с сервером –
выбор пал на SQL.

Рассматриваемый язык SQL ориентирован на операции с данными, представленными в виде логически
взаимосвязанных совокупностей таблиц-отношений. Важнейшая особенность его структур – ориентация
на конечный результат обработки данных, а не на процедуру этой обработки. Язык SQL сам определяет,
где находятся данные, индексы и даже какие наиболее эффективные последовательности операций
следует использовать для получения результата, а потому указывать эти детали в запросе к базе данных
не требуется.

Разделение SQL (это не различные языки, а разделы команд SQL сгруппированных по их функциям):

- DDL (Язык Определения Данных) — так называемый Язык Описания Схемы в ANSI, состоит из команд,
  которые создают объекты (таблицы, индексы, просмотры, и так далее) в базе данных.
- DML (Язык Манипулирования Данными) — это набор команд, которые определяют, какие значения
  представлены в таблицах в любой момент времени.
- DCD (Язык Управления Данными) состоит из средств, которые определяют, разрешить ли пользователю
  выполнять определенные действия или нет. Они являются составными частями DDL в ANSI.

SQL является языком, ориентированным на групповую обработку данных. Оператор SQL возвращает информацию
в табличный формат реляционной модели.

Имеется два типа встроенных SQL-операторов: статический SQL и динамический SQL. Статический SQL ссылается
на SQL-операторы, которые известны до момента запуска и в дальнейшем не изменяются, в то время как
динамические SQL-операторы определяются только во время выполнения программы.

SQL является языком высокого уровня. Во многих современных СУБД имеются построители запросов SQL. Обычно
в этом качестве выступают языки типа QBE. Но не все типы запросов SQL могут быть реализованы на QBE.
Некоторые типы запросов, например запрос-объединение (Union), невозможно создать на QBE.

Операторы SQL делятся на:

- операторы определения данных (Data Definition Language, DDL)
  - CREATE создает объект БД (саму базу, таблицу, представление, пользователя и т. д.)
  - ALTER изменяет объект
  - DROP удаляет объект

- операторы манипуляции данными (Data Manipulation Language, DML)
  - SELECT считывает данные, удовлетворяющие заданным условиям
  - INSERT добавляет новые данные
  - UPDATE изменяет существующие данные
  - DELETE удаляет данные

- операторы определения доступа к данным (Data Control Language, DCL)
  - GRANT предоставляет пользователю (группе) разрешения на определенные операции с объектом
  - REVOKE отзывает ранее выданные разрешения
  - DENY задает запрет, имеющий приоритет над разрешением

- операторы управления транзакциями (Transaction Control Language, TCL)
  - COMMIT применяет транзакцию.
  - ROLLBACK откатывает все изменения, сделанные в контексте текущей транзакции.
  - SAVEPOINT делит транзакцию на более мелкие участки.

## Преимущества и недостатки языка SQL

### Преимущества

Язык SQL является основой многих СУБД, т.к. отвечает за физическое структурирование и
запись данных на диск, а также за чтение данных с диска, позволяет принимать SQL-запросы
от других компонентов СУБД и пользовательских приложений. Таким образом, SQL – мощный
инструмент, который обеспечивает пользователям, программам и вычислительным системам
доступ к информации, содержащейся в реляционных базах данных.

Основные достоинства языка SQL заключаются в следующем:

- стандартность – как уже было сказано, использование языка SQL в программах стандартизировано
  международными организациями;

- независимость от конкретных СУБД – все распространенные СУБД используют SQL, т.к. реляционную
  базу данных можно перенести с одной СУБД на другую с минимальными доработками;

- возможность переноса с одной вычислительной системы на другую – СУБД может быть ориентирована
  на различные вычислительные системы, однако приложения, созданные с помощью SQL, допускают
  использование как для локальных БД, так и для крупных многопользовательских систем;

- реляционная основа языка – SQL является языком реляционных БД, поэтому он стал популярным тогда,
  когда получила широкое распространение реляционная модель представления данных. Табличная структура
  реляционной БД хорошо понятна, а потому язык SQL прост для изучения;

- возможность создания интерактивных запросов – SQL обеспечивает пользователям немедленный доступ к
  данным, при этом в интерактивном режиме можно получить результат запроса за очень короткое время без
  написания сложной программы;

- возможность программного доступа к БД – язык SQL легко использовать в приложениях, которым необходимо
  обращаться к базам данных. Одни и те же операторы SQL употребляются как для интерактивного, так и
  программного доступа, поэтому части программ, содержащие обращение к БД, можно вначале проверить в
  интерактивном режиме, а затем встраивать в программу;

- обеспечение различного представления данных – с помощью SQL можно представить такую структуру данных,
  что тот или иной пользователь будет видеть различные их представления. Кроме того, данные из разных
  частей БД могут быть скомбинированы и представлены в виде одной простой таблицы, а значит, представления
  пригодны для усиления защиты БД и ее настройки под конкретные требования отдельных пользователей;

- возможность динамического изменения и расширения структуры БД – язык SQL позволяет манипулировать
  структурой БД, тем самым обеспечивая гибкость с точки зрения приспособленности БД к изменяющимся
  требованиям предметной области;
  
- поддержка архитектуры клиент-сервер – SQL – одно из лучших средств для реализации приложений на
  платформе клиент-сервер. SQL служит связующим звеном между взаимодействующей с пользователем
  клиентской системой и серверной системой, управляющей БД, позволяя каждой из них сосредоточиться
  на выполнении своих функций.

Язык SQL – первый и пока единственный стандартный язык для работы с базами данных, который получил
достаточно широкое распространение. Практически все крупнейшие разработчики СУБД в настоящее время
создают свои продукты с использованием языка SQL либо с SQL-интерфейсом.

### Недостатки

- Несоответствие реляционной модели данных.
  Создатели реляционной модели данных Эдгар Кодд, Кристофер Дейт и их сторонники указывают на то,
  что SQL не является истинно реляционным языком. В опубликованном Кристофером Дейтом и Хью Дарвеном
  Третьем Манифестеони излагают принципы СУБД следующего поколения и предлагают язык Tutorial D, который
  является подлинно реляционным.
- Сложность.
  Хотя SQL и задумывался как средство работы конечного пользователя, в конце концов он стал настолько
  сложным, что превратился в инструмент программиста.
- Отступления от стандартов.
  Несмотря на наличие международного стандарта ANSI SQL-92, многие компании, занимающиеся разработкой
  СУБД (например, Oracle, Sybase, Microsoft, MySQL AB), вносят изменения в язык SQL, применяемый в
  разрабатываемой СУБД, тем самым отступая от стандарта. Таким образом, появляются специфичные для
  каждой конкретной СУБД диалекты языка SQL.
- Сложность работы с иерархическими структурами.
