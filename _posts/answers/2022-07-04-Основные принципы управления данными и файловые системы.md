---
layout: post
title: "Основные принципы управления данными и файловые системы"
categories: sppo-questions pors-questions
---

## Файловые системы

Наличие в составе современных ЭВМ таких внешних запоминающих устройств (ВЗУ), которые способны хранить большие массивы
данных в течение сколь угодно длительного времени, поставило перед разработчиками ОС задачу создания специальных систем
по управлению данными. Такая система фактически является интерфейсом между процессами (системными и пользовательскими),
с одной стороны, и данными, хранимыми в ВЗУ, с другой стороны, т.е. эта система должна обеспечить эти процессы
комплексом услуг по управлению данными. Таким образом, система управления данными (СУД) - это фактически виртуальная
система управления вводом-выводом данных, построенная на следующей базе:

1. существующей подсистемы управления вводом-выводом;
2. использования специальных аппаратных средств;
3. специальных информационных структур.

СУД называют файловыми системами, где файл - поименованная совокупность данных, обычно размещаемая в ВЗУ. Взаимодействие
программных процессов и файлов может быть представлено в виде следующей схемы:

![Схема взаимодействия программных процессов и файлов](/assets/q36-1.png)

Рис.1. Схема взаимодействия программных процессов и файлов

Таким образом, файловая система - это интерфейс между программными процессами и файлами. Назначение файловых систем
определяет состав их программных частей, которые должны иметь следующие компоненты:

Средства взаимодействия с процессами пользователей, которые должны обеспечить прием и интерпретацию запросов от
пользователей на обработку файлов и сообщить им в удобной форме о результатах этой обработки;

Средства, реализующие методы доступа к внутренним составным элементам файла и файлу в целом; эти средства осуществляют
связь между физическим и логическим уровнями управления данными;

Средства, обеспечивающие распределение внешней памяти для хранения файлов и ее освобождение при уничтожении файлов;

Средства учета расположения файлов в целом и их составных частей.

В мультипрограммных ОС одними из главных задач файловой системы являются также обеспечение эффективной - по времени и по
минимуму расхода ОП - работы этой системы, обеспечение гарантии сохранности файлов и защиты файлов от
несанкционированного доступа пользователей к "чужим" файлам.

### Логическая организация файлов

Арабские цифры от 0 до 9, буквы латинского и других алфавитов, специальные знаки (/, *, (, ) и т.д.) представляются в
ЭВМ в виде комбинации битов, в настоящее время чаще всего 8-битовых (байтов). Эти комбинации обычно называются
символами. Группа взаимосвязанных символов называется полем. Группа взаимосвязанных полей носит название записи.
Например, запись, относящаяся к студенту, может содержать отдельные поля, где будут указаны идентификационный номер,
фамилия, имя, отчество, адрес, изучавшиеся дисциплины и отметки по ним и т.д.

Ключ записи - это управляющее поле, которое однозначно идентифицирует данную запись. Например, при составлении платежной
ведомости о выдаче стипендии студентам в качестве ключа записи может использоваться идентификационный номер студента.
Группа взаимосвязанных записей составляет файл. Например, файл может состоять из записей, относящихся ко всем студентам
одного из факультетов университета.

Под логической организацией файлов понимается способ расположения записей файла во внешней памяти. В качестве примера
рассмотрим 2 из наиболее известных видов логической организации файлов: последовательную и библиотечную.

**Последовательная организация.**
Записи располагаются в физическом порядке, а сам файл рассматривается как одномерный массив логических записей, при этом
доступ к логическим записям - последовательный, т.е. после записи или считывания i-й записи доступна только (i+1)-я
запись. Такая организация применяется для файлов, хранящихся на магнитной ленте и выводимых на печать. Очевидный
недостаток такой организации для файлов, хранимых на дисках, состоит в большом времени поиска записи в файле.

**Библиотечная организация.**
В этом случае фактически имеется файл, состоящий из последовательных подфайлов, называемых элементами, или членами
файла. Начальный адрес каждого такого элемента хранится в каталоге (директории) файла.
Расположение элементов никак не упорядочено в общем случае - они записываются в библиотеку по мере поступления, но
названия элементов в каталоге библиотеки упорядочиваются в процессе создания этих элементов. Такая организация позволяет
легко расширять файл по мере поступления новых элементов.

![Библиотечная организация](/assets/q36-1.png)

### Физическая организация файлов

Физическая организация файлов определяется расположением данных на конкретном физическом носителе. При связном
распределении памяти каждому файлу отводится одна непрерывная область внешней памяти. Одним из достоинств связного
распределения является тот фактор, что последовательные логические записи размещаются, как правило, физически рядом. Это
позволяет повысить скорости доступа по сравнению с системами, в которых последовательные логические записи разбросаны по
диску. Однако связное распределение имеет и определенные недостатки. Когда файлы уничтожаются, занимаемое ими
пространство возвращается в список свободных ресурсов. Это пространство предоставляется для размещения новых файлов,
которые при этом должны укладываться в существующие свободные области. Таким образом, здесь, как и при распределении ОП
в мультипрограммном режиме работы ЭВМ, возникает проблема фрагментации. В настоящее время главенствующее положение
заняли системы несвязного поблочного распределения дисковой памяти. В этом случае физическая организация памяти чаще
всего существенно отличается от логической организации.
Рассмотрим некоторые способы физической организации дисковой памяти, наиболее часто используемые в настоящее время и
являющиеся вариантами так называемого поблочного распределения. При поблочном распределении память распределяется не
индивидуальными секторами, а блоками смежных секторов. При выделении новых секторов система стремится выбирать свободные
блоки, расположенные как можно ближе к уже существующим блокам файла.

**Распределение при помощи цепочек блоков.**
Блоки содержат фиксированное число смежных секторов. Для нахождения конкретной записи необходимо просмотреть цепочку
блоков до тех пор, пока не будет найден соответствующий блок, а затем просмотреть этот блок. Недостаток способа состоит
в том, что просмотр приходится начинать с самого начала, а если блоки анализируемого файла разбросаны по всему диску, то
могут быть велики потери на перемещение головок диска. Преимущество способа состоит в том, что при необходимости легко
произвести вставку и исключение блока путем модификации указателей предыдущих блоков.

![Распределение при помощи цепочек блоков](/assets/q36-2.png)

**Распределение при помощи цепочек индексов**
В схеме с цепочками индексов указатели помещаются в отдельные индексные блоки. Каждый индексный блок содержит
фиксированное число элементов. Каждая строка индексного блока содержит идентификатор обычного блока и указатель на этот
блок. Возможна также организация цепочки индексных блоков, если одного индексного блока недостаточно для указания
адресов блоков файла.
Преимущество этого способа по сравнению со способом цепочки блоков заключается в том, что при поиске блока
просматриваются только индексные блоки, которые к тому же могут быть размещены в ОП.
Недостаток способа состоит в том, что для вставки дополнительных записей может потребоваться полная перестройка
структуры индексных блоков, но при двух- и тем более при трехступенчатой организации индексных блоков вероятность того
события, что такая перестройка потребуется, весьма мала.
Подобный способ распределения использован в ОС UNIX.

![Распределение при помощи цепочек индексов](/assets/q36-3.png)

**Распределение при помощи таблиц поблочного отображения**
Преимущество способа заключается в простоте процедуры изменения структуры файла и наглядности распределения дискового
пространства. Способ используется в MS DOS.

![Распределение при помощи таблиц поблочного отображения](/assets/q36-4.png)

### Управление данными включает следующие компоненты:

- долговременное планирование — организацию размещения данных на внешних носителях, их выборку и предоставление
  пользовательским программам;
- оперативное управление — распределение оперативной памяти под программы и данные, реализацию обмена данными между
  оперативной и внешней памятью;
- управление внешними устройствами ввода-вывода и размещения данных.

#### Основные функции управления данными.

Управление данными предназначено для выполнения следующих функций:

- централизованного осуществления операций ввода-вывода (операций обмена) с использованием внешних (периферийных)
  устройств;
- обеспечения хранения данных на устройствах внешней памяти;
- обеспечения различных способов организации и идентификации данных;
- каталогизации данных, позволяющей осуществлять их поиск используя лишь символическое имя без указания местонахождения;
- автоматического распределения памяти на томах прямого доступа;
- автоматического поиска данных по их символическому имени;
- обеспечения независимости программ от характеристик данных, которые они обрабатывают, и типов используемых внешних
  устройств;
- обеспечения различных методов доступа к данным в зависимости от их организации и логического уровня способа доступа.

Централизованное выполнение операций ввода-вывода создает возможности для организации мультипрограммной обработки
данных и оптимизации операций обмена с внешними устройствами. Это позволяет сократить продолжительность простоев
центрального процессора и время выполнения заданий, увеличить эффективность использования внешних устройств.
Автоматизация процессов обмена информацией позволяет свести до минимума потребность в ручном вмешательстве оператора и
в значительной степени упростить процесс разработки и отладки программ.

Все функции управления данными, перечисленные выше, можно разделить на два вида:

- управление процессами ввода-вывода в вычислительной системе;
- организация данных, хранимых в вычислительной системе. Эта функция имеет отношение только к данным, хранимым на
  внешних запоминающих устройствах (НМД и НМЛ).

Оба вида функций реализуются через операции ввода-вывода, поэтому организация ввода-вывода является основой управления
данными.

Архитектура современных ЭВМ рассчитана на аппаратно-программную организацию операций ввода-вывода, которая предполагает
функционирование аппаратных средств ввода-вывода под управлением управляющей программы. Аппаратная часть организации
ввода-вывода основана на реализации этих операций в специализированных устройствах, называемых каналами ввода-вывода,
либо в специализированных ЭВМ (в зависимости от объема функций, выполняемых этими устройствами).

Важной особенностью этих устройств является то, что они функционируют параллельно и асинхронно с центральными
устройствами. Синхронизация работы центральных устройств и устройств ввода-вывода осуществляется при запуске и
завершении операций в устройстве.

Запуск устройств ввода-вывода осуществляется по специальным командам, выдаваемым управляющей программой центрального
процессора. При завершении операции ввода-вывода устройства выдают управляющей программе центрального процессора сигнал
прерывания. В процессе функционирования устройство ввода-вывода действует в соответствии с собственной программой.